%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%% PACKAGES %%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%% Thesis formatting %%%%%%%%%%%%%

\usepackage[parts,pdfspacing]{classicthesis}
\usepackage[a4paper, total={7in, 8.5in}]{geometry}

%%%%%%%%%%%%% Standard packages %%%%%%%%%%%%%
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{titlesec}
\usepackage{xr}
\usepackage{float}
\usepackage{graphicx}
\usepackage{subfiles}
\usepackage{datetime}
\usepackage[nottoc]{tocbibind}
\usepackage[
    font=small,
]{caption}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage{mathtools}
\numberwithin{equation}{chapter}
% Algorithm writing
\usepackage[ruled]{algorithm2e} 
\usepackage{newfloat,algcompatible} 
\widowpenalty=10000
\clubpenalty=10000
% \bibliographystyle{numeric-comp}

\usepackage{cite}
\usepackage{listings}
\usepackage{amssymb}
\usepackage[ampersand, itemize]{easylist}
\usepackage{enumitem}
\usepackage{hyperref}
\hypersetup{
  colorlinks = true, %Colours links instead of ugly boxes
  linkcolor={blue!50!black}, %Colour of internal links
  citecolor=red, %{red!50!black}, %Colour of citations
  urlcolor=blue, %Colour for external hyperlinks
  linktoc=page,
}

\newlist{postulate}{enumerate}{1}     % this creates a dedicated counter named 'subtaski'
\setlist[postulate,1]{label=\arabic*} % set form of enumeration label here

\usepackage[capitalise, nameinlink]{cleveref}
\crefname{postulatei}{postulate}{postulates}

%%%%%%%%%%%%% Nonstandard packages %%%%%%%%%%%%%
% \usepackage[
%   style=long,
%   % style=altlongragged4col, 
%   nolist, 
%   nonumberlist,
%   nopostdot,
%   acronym,
%   toc=true, 
% ]{glossaries}

\usepackage[
  style=long,
  % style=altlongragged4col, 
  nolist, 
  nonumberlist,
  nopostdot,
  acronym,
  toc=true, 
]{glossaries-extra}
% TODO get glsrestall links working again: check https://tex.stackexchange.com/questions/590724/equivalent-of-glsresetall-in-glossaries-extra
\GlsXtrEnableLinkCounting[subsection]{general,acronym}
\renewcommand*{\glslinkpresetkeys}{%
 \ifnum\GlsXtrLinkCounterValue{\glslabel}>1
  \setkeys{glslink}{hyper=false}%
 \fi
}


\renewcommand{\glsnamefont}[1]{\textbf{#1}}
\setlength\glsdescwidth{0.8\hsize}
% \setabbreviationstyle{long-short-desc} % this should make acronyms tidier but requires glossaries-extra
\usepackage{floatpag}

\usepackage[colorinlistoftodos,prependcaption,textsize=tiny]{todonotes}
\usepackage{braket}
\usepackage{amsthm}
\usepackage{nicefrac}
\usepackage{longtable}
\usepackage{multirow}
\usepackage{siunitx}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%% Settings %%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Format figures, tables etc
\makeatletter
\@addtoreset{table}{chapter}
\makeatother
\renewcommand\thetable{\thechapter.\arabic{table}}

\makeatletter
\@addtoreset{figure}{chapter}
\makeatother
\renewcommand\thefigure{\thechapter.\arabic{figure}}

\renewcommand{\thefootnote}{\fnsymbol{footnote}}
\newcommand{\tabitem}{~~\llap{\textbullet}~~}
\usepackage{rotating}
\usepackage{changepage}

\pagestyle{scrheadings} % <--- Affects the page header 
                        % and page number in the footer.
\clearscrheadfoot
\ohead{\rightmark}  % comment this line and uncomment the next
                    % to switch to `chapter name` in the heading
%\ohead{\leftmark}  % comment out to 
\cfoot[\pagemark]{\pagemark}

% Ensure chapter/part numbers are legible and formatted 
\titleformat{\chapter}[display]  
{\relax}{\vspace*{-3\baselineskip}\makebox[\linewidth][r]{\color{halfgray}\chapterNumber\thechapter}}{0pt}%
{\raggedright\spacedallcaps}[\normalsize\vspace*{.8\baselineskip}\titlerule]%

\renewcommand{\thepart}{\Roman{part}}
\titleformat{\part}[display]{\normalfont\large\centering}{\thispagestyle{empty}\partname~\thepart}{1em}{\color{red}\spacedallcaps}

% Listing formatting
\lstset{
  % numbers=left, % comment this line to remove line numbers from code listings
  numberstyle=\small, 
  numbersep=8,
  frame=single, 
  language=Python, 
  xleftmargin=.05\textwidth,
  xrightmargin=.02\textwidth,
  framexleftmargin=20pt,
  framextopmargin=6pt,
  framexbottommargin=6pt, 
  breaklines=TRUE,
  showstringspaces=false,
  captionpos=b,
  deletekeywords={NUMBER}
}
\renewcommand{\thefootnote}{\arabic{footnote}}

% Miscellaneous settings
\setcounter{secnumdepth}{4}

% \theoremstyle{plain}
% \newtheorem{theorem}{Theorem}[section]
% \newtheorem{lemma}[thm]{Lemma}
% \newtheorem{proposition}[thm]{Proposition}
% \newtheorem*{corollary}{Corollary}

% \theoremstyle{definition}
% \newtheorem{definition}{Definition}[section]
% \newtheorem{conjecture}{Conjecture}[section]
\newtheorem{example}{Example}[section]

% \theoremstyle{remark}
% \newtheorem*{remark}{Remark}
% \newtheorem*{note}{Note}
\usepackage{xcolor}

\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]

\theoremstyle{remark}
\newtheorem*{remark}{Remark}

\usepackage{afterpage}
\newcommand\myemptypage{
    \null
    \thispagestyle{empty}
    \addtocounter{page}{-1}
    \newpage
    }

\newcommand\forceemptypage{
  \newpage
  \thispagestyle{plain} % empty
  \mbox{}
}
